---
title: Windows DNS Server
date: 2019-05-19 15:10:34
tags:
- DNS
categories:
- windows
---

### 关于Windows Serve 2008R2下搭建DNS服务器的一点总结

**首先windows服务器管理添加DNS服务**

#### 对于DNS服务器的一些功能的说明
**全局日志**
额，看名字就知道是保存dns日志的地方

**正向查找区域 **
正向查找区域用于FQDN到IP地址的映射，当DNS客户端请求解析某个FQDN时，DNS服务器在正向查找区域中进行查找，并返回给DNS客户端对应的IP地址；
**反向查找区域**
反向查找区域用于IP地址到FQDN的映射，当DNS客户端请求解析某个IP地址时，DNS服务器在反向查找区域中进行查找，并返回给DNS客户端对应的FQDN
新建区域 会有主要区域、辅助区域、存根区域
* 主要区域：包含相应DNS命名空间所有的资源记录，是区域中所包含的所有DNS域的权威DNS服务器。可以对区域中所有资源记录进行读写，即DNS服务器可以修改此区域中的数据，默认情况下区域数据以文本文件格式存放。你可以将主要区域的数据存放在活动目录中并且随着活动目录数据的复制而复制，此时，此区域称为活动目录集成主要区域，在这种情况下，每一个运行在域控制器上的DNS服务器都可以对此主要区域进行读写，这样避免了标准主要区域时出现的单点故障。

* 辅助区域：主要区域的备份，从主要区域直接复制而来;同样包含相应DNS命名空间所有的资源记录，是区域中所包含的所有DNS域的权威DNS服务器;和主要区域不同之处是DNS服务器不能对辅助区域进行任何修改，即辅助区域是只读的。辅助区域数据只能以文本文件格式存放。

* 存根区域：存根区域是Windows Server 2003新增加的功能。此区域只是包含了用于分辨主要区域权威DNS服务器的记录，有三种记录类型:
   1. SOA(委派区域的起始授权机构):此记录用于识别该区域的主要来源DNS服务器和其他区域属性;
   2. NS(名称服务器):此记录包含了此区域的权威DNS服务器列表;
   3. A glue(粘附A记录):此记录包含了此区域的权威DNS服务器的IP地址。
   默认情况下区域数据以文本文件格式存放，不过你可以和主要区域一样将存根区域的数据存放在活动目录中并且随着活动目录数据的复制而复制。
   当DNS客户端发起解析请求时:
   1.对于属于所管理的主要区域和辅助区域的解析，DNS服务器向DNS客户端执行权威答复。
   2.而对于所管理的 存根区域 的解析，如果客户端发起递归查询，则DNS 服务器会使用该存根区域中的资源记录来解析查询。DNS服务器向存根区域的NS资源记录中指定的权威DNS服务器(SOA)发送迭代查询，仿佛在使用其缓存中的NS资源记录一样;如果DNS服务器找不到其存根区域中的权威DNS服务器，那么DNS服务器会尝试使用  根提示信息  进行标准递归查询。如果客户端发起迭代查询，DNS服务器会返回一个包含存根区域中指定服务器的参考信息，而不再进行其他操作。
   如果存根区域的权威DNS服务器对本地DNS服务器发起的解析请求进行答复，本地DNS服务器会将接收到的资源记录存储在自己的缓存中，而
   不是将这些资源记录存储在存根区域中，唯一的例外是返回的粘附A记录，它会存储在存根区域中。存储在缓存中的资源记录按照每个资源记录
   中的生存时间 (TTL) 的值进行缓存;而存放在存根区域中的SOA、NS 和粘附A资源记录按照SOA记录中指定的过期间隔过期(该过期间隔是在创建
   存根区域期间创建的，在从原始主要区域复制时更新)。
   　　当某个DNS服务器(父DNS服务器)向另外一个DNS服务器做子区域委派时，如果子区域中添加了新的权威DNS服务器，父DNS服务器是不会知道
   的，除非你在父DNS服务器上手动添加。存根区域主要是用于解决这个问题，你可以在父DNS服务器上为委派的子区域做一个存根区域，从而可
   以从委派的子区域自动获取权威DNS服务器的更新而不需要额外的手动操作。
   本文转自OnMyWay博客51CTO博客，原文链接http://blog.51cto.com/active/290498如需转载请自行联系原作者

#### 我们一般需要用到的
  1. 正向查找区域
  用于指定特定域名对应的IP地址 需要注意的是域名第一个 **.**前面的是主机，后面代表域。例如a.b.c.com 我们创建正向主要区域只需创建域 b.c.com 然后在域中创建a主机。

  2. 条件转发器
   此项是将特定的域转发到特定的dns服务器上 例如 我想把a.b.com 这个域交由内网其他dns服务器解析 则可在条件转发器配置相关域转发。
  3. 转发器
  转发器 是当上述条件都不匹配时，转发到转发器上指定的dns中。
###
